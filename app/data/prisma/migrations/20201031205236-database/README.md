# Migration `20201031205236-database`

This migration has been generated by IanGrubb at 10/31/2020, 4:52:36 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
"id" SERIAL,
"username" text   NOT NULL ,
"password" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."JamsUpdate" (
"id" SERIAL,
"userId" integer   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TrackAddition" (
"id" SERIAL,
"trackId" text   NOT NULL ,
"jamsUpdateId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TrackRemoval" (
"id" SERIAL,
"trackId" text   NOT NULL ,
"jamsUpdateId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_UserFollows" (
"A" integer   NOT NULL ,
"B" integer   NOT NULL 
)

CREATE UNIQUE INDEX "User.username_unique" ON "public"."User"("username")

CREATE UNIQUE INDEX "_UserFollows_AB_unique" ON "public"."_UserFollows"("A", "B")

CREATE INDEX "_UserFollows_B_index" ON "public"."_UserFollows"("B")

ALTER TABLE "public"."JamsUpdate" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TrackAddition" ADD FOREIGN KEY ("jamsUpdateId")REFERENCES "public"."JamsUpdate"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TrackRemoval" ADD FOREIGN KEY ("jamsUpdateId")REFERENCES "public"."JamsUpdate"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_UserFollows" ADD FOREIGN KEY ("A")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_UserFollows" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201031205236-database
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,41 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model User {
+  id              Int          @id @default(autoincrement())
+  username        String       @unique
+  password        String
+  createdAt       DateTime     @default(now())
+  followedBy      User[]       @relation("UserFollows", references:[id])
+  following       User[]       @relation("UserFollows", references:[id])
+  jamsUpdates     JamsUpdate[]
+}
+
+model JamsUpdate {
+  id             Int             @id @default(autoincrement())
+  userId         Int
+  createdAt      DateTime        @default(now())
+  user           User            @relation(fields: [userId], references: [id])
+  trackAdditions TrackAddition[]
+  trackRemovals  TrackRemoval[]
+}
+
+model TrackAddition {
+  id           Int        @id @default(autoincrement())
+  trackId      String
+  jamsUpdateId Int
+  jamsUpdate   JamsUpdate @relation(fields: [jamsUpdateId], references: [id])
+}
+
+model TrackRemoval {
+  id           Int        @id @default(autoincrement())
+  trackId      String
+  jamsUpdateId Int
+  jamsUpdate   JamsUpdate @relation(fields: [jamsUpdateId], references: [id])
+}
```


